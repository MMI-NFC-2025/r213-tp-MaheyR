---
import Layout from "../layouts/Layout.astro";
import OffreCard from "../components/OffreCard.astro";
import { getOffres } from "../js/backend.mjs";

const offres = await getOffres();
---

<Layout titre="Offres">
  <h1 class="text-2xl font-bold">Offres</h1>
  <p class="mt-2 text-gray-600">Voici quelques offres.</p>

  <!-- Bouton -->
  <button
    id="favori-button"
    class="mt-4 bg-slate-600 rounded-lg text-white p-2"
  >
    Afficher les favoris
  </button>

  <!-- Liste des offres -->
  <div class="mt-6 space-y-4">
    {
      offres.map((offre) => (
        <div class="offre" data-favori={offre.favori.toString()}>
          <OffreCard offre={offre} />
        </div>
      ))
    }
  </div>

  <!-- Script -->
  <script>
    const button = document.getElementById('favori-button');
    let showOnlyFavorites = false;

    button?.addEventListener('click', () => {
      showOnlyFavorites = !showOnlyFavorites;
      const offres = document.querySelectorAll('.offre');

      offres.forEach((offre) => {
        const isFavori = offre.dataset.favori === 'true';

        if (showOnlyFavorites) {
          offre.style.display = isFavori ? 'block' : 'none';
          button.textContent = 'Afficher tout';
        } else {
          offre.style.display = 'block';
          button.textContent = 'Afficher les favoris';
        }
      });
    });
  </script>
</Layout>





